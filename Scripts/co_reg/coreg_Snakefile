rule all:
    input:
        "/Users/reedkenny/OneDrive - Cal Poly/data/LiDAR/Palisades/Registered_DEMS/palisades_prefire_CHM_burned_reg.tif",
        "/Users/reedkenny/OneDrive - Cal Poly/data/LiDAR/Eaton/Registered_DEMS/eaton_prefire_CHM_burned_reg.tif"
        

rule co_reg_pre_eaton:
    input:
        pan="/Users/reedkenny/OneDrive - Cal Poly/Advanced_GIS_data/Maxar/Eaton/PRE/Eaton_prefire_pan/{all_pan_tile_num}.tif",
        dem="/Users/reedkenny/Desktop/Urban_tree_fire/landscape_analysis/Data/eaton_chm_2023_epsg32611.tif"
    output:
        "/Users/reedkenny/OneDrive - Cal Poly/data/LiDAR/Eaton/Registered_DEMS/{all_pan_tile_num}_phase.tif"
    shell:
        """
        python batch_phase_coreg.py \
          --input_pan "{input.pan}" \
          --input_dem "{input.dem}" \
          --output "{output}"
        """
        
rule co_reg_pre_palisades:
    input:
        pan="/Users/reedkenny/OneDrive - Cal Poly/data/Maxar/Palisades/Palisades_pre/016569561010_01_P001_PAN/24OCT20184323-P3DS-016569561010_01_P001.tif",
        dem="/Users/reedkenny/OneDrive - Cal Poly/data/LiDAR/pal_chm_2023_epsg32611.tif"
    output:
        "/Users/reedkenny/OneDrive - Cal Poly/data/LiDAR/Palisades/Registered_DEMS/palisades_prefire_CHM_reg.tif"
    shell:
        """
        python batch_phase_coreg.py \
          --input_pan "{input.pan}" \
          --input_dem "{input.dem}" \
          --output "{output}"
        """
        
rule stich_lidar:
    input:
        "/Users/reedkenny/OneDrive - Cal Poly/data/LiDAR/Eaton/Registered_DEMS/all_pan_tile_1_phase.tif",
        "/Users/reedkenny/OneDrive - Cal Poly/data/LiDAR/Eaton/Registered_DEMS/all_pan_tile_2_phase.tif",
        "/Users/reedkenny/OneDrive - Cal Poly/data/LiDAR/Eaton/Registered_DEMS/all_pan_tile_3_phase.tif",
        "/Users/reedkenny/OneDrive - Cal Poly/data/LiDAR/Eaton/Registered_DEMS/all_pan_tile_4_phase.tif",
        "/Users/reedkenny/OneDrive - Cal Poly/data/LiDAR/Palisades/Registered_DEMS/palisades_prefire_CHM_reg.tif"
    output:
        "/Users/reedkenny/OneDrive - Cal Poly/data/LiDAR/Eaton/Registered_DEMS/eaton_prefire_CHM_burned_reg.tif",
        "/Users/reedkenny/OneDrive - Cal Poly/data/LiDAR/Eaton/Registered_DEMS/eaton_prefire_CHM_unburned_reg.tif", 
        "/Users/reedkenny/OneDrive - Cal Poly/data/LiDAR/Palisades/Registered_DEMS/palisades_prefire_CHM_burned_reg.tif",
        "/Users/reedkenny/OneDrive - Cal Poly/data/LiDAR/Palisades/Registered_DEMS/palisades_prefire_CHM_unburned_reg.tif"
    shell:
        """
        Rscript Stich_lidar.R
        """
        


        
